
import React, { createContext, useState, useContext, useEffect, useCallback } from 'react';
import { Language } from './types';

const translations = {
  ar: {
    discoverPleasureOfLearning: "اكتشف متعة التعلم",
    back: "رجوع",
    logout: "خروج",
    comingSoonTitle: "قريبا...",
    comingSoonMessage: "هذه الميزة قيد التطوير حاليًا. ترقبوا التحديثات!",
    notifications: "الإشعارات",
    noNewNotifications: "لا توجد إشعارات جديدة.",
    notificationMessage: "تمت إضافة ملاحظة جديدة من الأستاذ في مادة {subject}.",
    notificationNewSummary: "تمت إضافة ملخص جديد في مادة {subject}.",
    notificationNewExercise: "تمت إضافة تمارين جديدة في مادة {subject}.",
    notificationNewExamProgram: "تمت إضافة برنامج فروض جديد في مادة {subject}.",
    unifiedLoginWelcome: "مرحبا بك في تطبيق امتياز",
    unifiedLoginPrompt: "الرجاء إدخال رمز الدخول الخاص بك",
    loginCodePlaceholder: "رمز الدخول",
    login: "الدخول",
    requestHelp: "طلب مساعدة",
    helpNote: "ملاحظة: عند الضغط على طلب مساعدة ستتحول تلقائيا إلى الإتصال برقم هاتفي.",
    invalidCode: "الرمز المدخل غير صحيح. الرجاء المحاولة مرة أخرى أو طلب المساعدة.",
    superAdminDashboardTitle: "لوحة تحكم المدير الخارق",
    addSchoolSectionTitle: "إضافة مدرسة جديدة",
    newSchoolNamePlaceholder: "اسم المدرسة الجديدة",
    principalSecretCodePlaceholder: "الرمز السري الخاص بالمدير",
    addSchool: "إضافة المدرسة",
    enterSchoolNameAndCode: "الرجاء إدخال اسم المدرسة ورمز المدير.",
    currentSchools: "المدارس الحالية",
    principalCodeLabel: "رمز المدير",
    delete: "حذف",
    confirmDeleteSchool: "هل أنت متأكد من رغبتك في حذف مدرسة \"{schoolName}\"؟ سيتم حذف جميع بياناتها بشكل دائم.",
    noSchoolsAdded: "لا توجد مدارس مضافة بعد.",
    principalDashboardTitle: "لوحة تحكم المدير(ة)",
    principalWelcome: "أهلاً بك. اختر الإجراء المطلوب.",
    manageTeachers: "إدارة الأساتذة",
    manageStudents: "إدارة التلاميذ",
    announcements: "الإعلانات",
    exercises: "تمارين أسبوعية",
    summaries: "الملخصات",
    complaintsAndSuggestions: "عرض الاقتراحات والشكاوى",
    educationalTips: "نصائح تربوية",
    performanceTracking: "تتبع أداء التلاميذ",
    reviewNotes: "مراجعة الملاحظات",
    guardianDashboardTitle: "لوحة تحكم ولي الأمر",
    studentLevel: "المستوى",
    selectSubjectToFollow: "اختر المادة للمتابعة",
    viewAnnouncements: "عرض الإعلانات",
    viewEducationalTips: "عرض النصائح التربوية",
    submitComplaintOrSuggestion: "تقديم شكوى أو اقتراح",
    teacherDashboardTitle: "لوحة تحكم الأستاذ(ة)",
    teacherSelectLevelAndSubject: "الرجاء تحديد المستوى والمادة",
    level: "المستوى",
    subject: "المادة",
    next: "التالي",
    add: 'إضافة',
    teacherName: 'اسم الأستاذ(ة)',
    loginCode: 'رمز الدخول',
    levels: 'المستويات',
    classes: 'الأفواج',
    addTeacher: 'إضافة أستاذ',
    existingTeachers: 'الأساتذة الحاليون',
    confirmDeleteTeacher: 'هل أنت متأكد من حذف الأستاذ {name}؟',
    noTeachers: 'لا يوجد أساتذة حاليا.',
    edit: 'تعديل',
    updateTeacher: 'تحديث البيانات',
    announcementContent: 'محتوى الإعلان',
    attachFile: 'إرفاق ملف (صورة أو PDF)',
    targetAudience: 'إرسال إلى',
    guardians: 'أولياء الأمور',
    teachers: 'الأساتذة',
    sendAnnouncement: 'إرسال الإعلان',
    sentAnnouncements: 'الإعلانات المرسلة',
    complaintContent: 'محتوى الشكوى / الاقتراح',
    submit: 'إرسال',
    receivedComplaints: 'الشكاوى والاقتراحات المستلمة',
    fromGuardianOf: 'من ولي أمر التلميذ(ة)',
    educationalTipContent: 'محتوى النصيحة',
    generateWithAI: 'توليد نصيحة بالذكاء الاصطناعي',
    sendTip: 'إرسال النصيحة',
    sentTips: 'النصائح المرسلة',
    performanceOverview: 'نظرة عامة على الأداء',
    averageGradePerLevel: 'متوسط المعدلات حسب المستوى',
    levelPerformance: 'أداء المستوى: {level}',
    studentName: 'اسم التلميذ',
    averageGrade: 'المعدل العام',
    performanceTrend: 'منحنى التطور',
    noComplaints: 'لا توجد شكاوى أو اقتراحات حاليا.',
    noAnnouncements: 'لا توجد إعلانات حاليا.',
    noTips: 'لا توجد نصائح حاليا.',
    confirm: 'تأكيد',
    cancel: 'إلغاء',
    fillAllFields: 'الرجاء ملء جميع الحقول.',
    guardianNotesTitle: 'الملاحظات والغيابات',
    addStudent: 'إضافة تلميذ',
    guardianCode: 'رمز ولي الأمر',
    existingStudents: 'التلاميذ الحاليون',
    confirmDeleteStudent: 'هل أنت متأكد من حذف التلميذ {name}؟',
    noStudents: 'لا يوجد تلاميذ حاليا.',
    class: 'القسم',
    statisticsDashboard: 'لوحة الإحصائيات',
    interviewRequests: 'طلبات المقابلة',
    monthlyFees: 'الواجبات الشهرية',
    schoolManagement: 'إدارة المدرسة',
    importFromExcel: 'استيراد التلاميذ من ملف اكسل',
    importInstructions: "يجب أن يحتوي الملف على عمودين: العمود الأول لأسماء التلاميذ، والعمود الثاني للرمز السري الخاص بأوليائهم.",
    selectFile: 'اختر ملف إكسل',
    import: 'استيراد',
    importSuccess: 'تم استيراد {count} تلميذ بنجاح.',
    importError: 'حدث خطأ أثناء الاستيراد. يرجى التحقق من تنسيق الملف.',
    selectLevelAndClass: 'الرجاء اختيار المستوى والقسم أولاً.',
    manageSchool: 'إدارة المدرسة',
    schoolStatus: 'حالة المدرسة',
    active: 'نشطة',
    inactive: 'متوقفة',
    maintenanceTitle: 'التطبيق في وضع الصيانة',
    maintenanceMessage: 'التطبيق يخضع حالياً للصيانة. الرجاء المحاولة مرة أخرى لاحقاً.',
    statisticsDashboard_feature: "خاصية: لوحة الإحصائيات",
    educationalTips_feature: "خاصية: نصائح تربوية",
    announcements_feature: "خاصية: الإعلانات",
    complaintsAndSuggestions_feature: "خاصية: الشكاوى والاقتراحات",
    reviewNotes_feature: "خاصية: مراجعة الملاحظات",
    monthlyFees_feature: "خاصية: الرسوم الشهرية",
    interviewRequests_feature: "خاصية: طلبات المقابلة",
    schoolManagement_feature: "خاصية: إدارة المدرسة",
    manage: "إدارة",
    featureToggleTitle: "تفعيل / تعطيل الميزات",
    browseAsTeacher: "التصفح كأستاذ",
    browseAsTeacher_feature: "خاصية: التصفح كأستاذ",
    selectLevelAndSubjectPrompt: "الرجاء اختيار المستوى، المادة والقسم",
    selectClassPrompt: "الرجاء اختيار القسم",
    sendForReview: "إرسال للمراجعة",
    sentForReviewSuccess: "تم إرسال الملاحظة للمراجعة بنجاح!",
    aiGeneratedNote: "✨ ملاحظة من الذكاء الاصطناعي",
    feeNotification: "قام التلميذ(ة) {studentName} بأداء الواجب الشهري بقيمة {amount} درهم.",
    payNow: "أداء الواجب الآن",
    paymentAmount: "المبلغ المدفوع (درهم)",
    paymentHistory: "سجل الأداء",
    paidOn: "تم الأداء بتاريخ",
    paymentSuccessful: "تم الأداء بنجاح!",
    requestInterview: "طلب مقابلة",
    confirmRequestInterview: "تأكيد طلب المقابلة",
    requestSent: "تم إرسال طلبك بنجاح.",
    paymentStatus: "حالة الأداء",
    paid: "أدى الواجب",
    notPaid: "لم يؤد الواجب",
    markAsPaid: "تغيير إلى 'أدى'",
    principalFeeManagement: "حالة أداء التلاميذ للواجب الشهري",
    noInterviewRequests: "لا توجد طلبات مقابلة حاليا.",
    requestFrom: "طلب من ولي أمر التلميذ(ة) {studentName}",
    markAsCompleted: "تمت المقابلة",
    monthlyFeePrompt: "هنا يمكنك تتبع وأداء الواجبات الشهرية للسنة الدراسية.",
    noPayments: "لا يوجد سجل أداء.",
    requestInterviewPrompt: "هل تود تأكيد طلب مقابلة مع الإدارة؟",
    payByCard: "الأداء عبر البطاقة البنكية",
    cardDetails: "معلومات البطاقة",
    cardNumber: "رقم البطاقة",
    expiryDate: "تاريخ انتهاء الصلاحية (MM/YY)",
    cvc: "رمز التحقق (CVC)",
    cardholderName: "اسم حامل البطاقة",
    confirmPayment: "تأكيد الدفع",
    processingPayment: "جاري معالجة الدفع...",
    academicYearMonths: "شهور السنة الدراسية",
    paymentDue: "واجب الأداء",
    paymentCompleted: "تم الأداء",
    pay: "أداء",
    setMonthlyFee: 'تحديد الواجب الشهري',
    // FIX: Added missing translation key for monthly fee screens.
    monthlyFee: 'الواجب الشهري',
    monthlyFeeAmountLabel: 'قيمة الواجب الشهري (درهم)',
    transportation: 'النقل',
    totalAmount: 'المبلغ الإجمالي',
    setTransportationFee: 'تحديد رسوم النقل',
    transportationFeeAmountLabel: 'قيمة رسوم النقل (درهم)',
    
    // Features from user prompt
    supplementaryLessons: 'الدروس الداعمة والتفاعلية',
    addSupplementaryLesson: 'إضافة درس داعم',
    lessonTitle: 'عنوان الدرس/الرابط',
    externalLink: 'الرابط الخارجي (يوتيوب، موقع تعليمي... إلخ)',
    addLink: 'إضافة الرابط',
    noLessons: 'لا توجد دروس داعمة حاليا.',
    
    timetable: 'جدول التوقيت',
    addTimetable: 'إضافة جدول توقيت',
    uploadTimetable: 'تحميل جدول التوقيت (صورة أو PDF)',
    noTimetable: 'لا يوجد جدول توقيت حالي.',

    quizzes: 'اختبارات قصيرة',
    addQuiz: 'إضافة اختبار قصير',
    generateQuizFromImage: 'إنشاء اختبار من صورة',
    uploadImageForQuiz: 'ارفع صورة لملخص أو تمارين لإنشاء اختبار',
    generatingQuiz: 'جاري إنشاء الاختبار بالذكاء الاصطناعي...',
    quizGenerated: 'تم إنشاء الاختبار بنجاح! الرجاء مراجعته قبل الحفظ.',
    saveQuiz: 'حفظ الاختبار',
    noQuizzes: 'لا توجد اختبارات قصيرة حاليا.',

    unitProject: 'مشروع الوحدة',
    addProject: 'إضافة مشروع',
    projectTitle: 'عنوان المشروع',
    projectDescription: 'وصف المشروع',
    takePhoto: 'التقاط صورة',
    uploadPhoto: 'رفع صورة',
    noProjects: 'لا توجد مشاريع حاليا.',
    capture: 'التقاط',

    digitalLibrary: 'مكتبة القسم الرقمية',
    addBook: 'إضافة كتاب أو قصة',
    bookTitle: 'عنوان الكتاب',
    bookDescription: 'وصف قصير',
    uploadBook: 'تحميل الكتاب (PDF)',
    download: 'تحميل',
    noBooks: 'المكتبة فارغة حاليا.',
    
    manageFees: 'إدارة الرسوم',
    update: 'تحديث',
    feesUpdated: 'تم تحديث الرسوم بنجاح!',

    // New AI Features & Album
    lessonPlanner: 'مخطط الدروس',
    lessonTopic: 'موضوع الدرس',
    generatePlan: 'إنشاء الخطة',
    generatingPlan: 'جاري إنشاء الخطة...',
    lessonPlan: 'خطة الدرس',
    learningObjectives: 'الأهداف التعليمية',
    inClassActivities: 'أنشطة مقترحة',
    homework: 'واجبات منزلية',
    discussionQuestions: 'أسئلة للمناقشة',

    personalizedExercises: 'تمارين مخصصة',
    generateExercises: 'إنشاء تمارين مخصصة',
    selectStudentForExercises: 'اختر تلميذا لإنشاء تمارين مخصصة له',
    generatingExercises: 'جاري إنشاء التمارين...',
    supportExercises: 'تمارين دعم',
    enrichmentExercises: 'تمارين إثراء',
    saveAndSendExercises: 'حفظ وإرسال التمارين',
    noPersonalizedExercises: 'لا توجد تمارين مخصصة حاليا.',
    notificationNewPersonalizedExercise: 'تمت إضافة تمارين مخصصة جديدة لك في مادة {subject}.',

    insightsDashboard: 'تحليل الشكاوى (BETA)',
    analyzeComplaints: 'تحليل الشكاوى بالذكاء الاصطناعي',
    generatingAnalysis: 'جاري التحليل...',
    complaintAnalysis: 'تحليل الشكاوى',
    commonThemes: 'المواضيع المتكررة',
    sentimentSummary: 'ملخص المشاعر العامة',
    noComplaintsToAnalyze: 'لا توجد شكاوى كافية للتحليل.',

    classAlbum: 'ألبوم الفصل',
    addPhoto: 'إضافة صورة للألبوم',
    photoCaption: 'أضف تعليقاً على الصورة',
    savePhoto: 'حفظ الصورة',
    noPhotos: 'الألبوم فارغ حاليا.',
    notificationNewPhoto: 'تمت إضافة صورة جديدة إلى ألبوم الفصل.',
    reviewAlbumPhotos: 'مراجعة صور الألبوم',
    approve: 'قبول',
    reject: 'رفض',
    pendingReview: 'قيد المراجعة',
    approved: 'موافق عليه',
    photoSentForReview: 'تم إرسال الصورة للمراجعة بنجاح.',
    noPhotosToReview: 'لا توجد صور في انتظار المراجعة.',
    reviewAlbumPhotos_feature: 'خاصية: مراجعة صور الألبوم',
    notificationNewPhotoForReview: 'صورة جديدة من الأستاذ تنتظر المراجعة.',
    unifiedAssessments: 'التقويمات الموحدة',
    addUnifiedAssessment: 'إضافة تقويم موحد',
    assessmentTitle: 'عنوان التقويم',
    noAssessments: 'لا توجد تقويمات موحدة حاليا.',
    notificationNewUnifiedAssessment: 'تمت إضافة تقويم موحد جديد في مادة {subject}.',
    saveSuccess: 'تم الحفظ بنجاح!',
    confirmDeleteAssessment: 'هل أنت متأكد من حذف هذا التقويم؟',
    confirmDeleteQuiz: 'هل أنت متأكد من حذف هذا الاختبار؟',
    confirmDeleteProject: 'هل أنت متأكد من حذف هذا المشروع؟',

    notesAndAbsences: 'الملاحظات والغيابات',
    studentGrades: 'مستوى التلميذ(ة)',
    examProgram: 'برنامج الفروض',
    aiNotes: 'ملاحظات بالذكاء الإصطناعي',
    notes: 'الملاحظات',
    darkMode: "الوضع الليلي",
    
    // Stages and new subjects
    pre_schoolStage: "التعليم الأولي",
    primaryStage: "المرحلة الابتدائية",
    middleStage: "المرحلة الإعدادية",
    highStage: "المرحلة الثانوية",
    selectStage: "اختر المرحلة الدراسية",
    'اللغة الإنجليزية': 'اللغة الإنجليزية',
    'الفيزياء والكيمياء': 'الفيزياء والكيمياء',
    'علوم الحياة والأرض': 'علوم الحياة والأرض',
    'المعلوميات': 'المعلوميات',
    'الفلسفة': 'الفلسفة',
    'التربية الإسلامية': 'التربية الإسلامية',
    'الاجتماعيات': 'الاجتماعيات',
    'اللغة العربية': 'اللغة العربية',
    'اللغة الفرنسية': 'اللغة الفرنسية',
    'الرياضيات': 'الرياضيات',

    // New Feature Flags
    principalFeaturesSection: "ميزات المدير",
    teacherFeaturesSection: "ميزات المعلم",
    guardianFeaturesSection: "ميزات ولي الأمر",
    financialManagement_feature: 'خاصية: الإدارة المالية',
    teacherManageSummaries_feature: 'خاصية: إدارة الملخصات',
    teacherManageExercises_feature: 'خاصية: إدارة التمارين',
    teacherManageNotesAndAbsences_feature: 'خاصية: إدارة الملاحظات والغياب',
    teacherManageGrades_feature: 'خاصية: إدارة النقط',
    teacherManageExamProgram_feature: 'خاصية: إدارة برنامج الفروض',
    teacherGenerateAiNotes_feature: 'خاصية: ملاحظات بالذكاء الاصطناعي',
    teacherLessonPlanner_feature: 'خاصية: مخطط الدروس بالذكاء الاصطناعي',
    teacherPersonalizedExercises_feature: 'خاصية: تمارين مخصصة بالذكاء الاصطناعي',
    teacherManageSupplementaryLessons_feature: 'خاصية: إدارة الدروس الداعمة',
    teacherManageUnifiedAssessments_feature: 'خاصية: إدارة التقويمات الموحدة',
    teacherManageTimetable_feature: 'خاصية: إدارة جداول الحصص',
    teacherManageQuizzes_feature: 'خاصية: إدارة الاختبارات القصيرة',
    teacherManageProjects_feature: 'خاصية: إدارة مشاريع الوحدة',
    teacherManageLibrary_feature: 'خاصية: إدارة المكتبة الرقمية',
    teacherManageAlbum_feature: 'خاصية: إدارة ألبوم الفصل',
    teacherManageTalkingCards_feature: 'خاصية: إدارة البطاقات الناطقة',
    // FIX: Corrected duplicate key by updating value and removing later re-definition.
    teacherManageMemorization_feature: 'خاصية: مساعد الحفظ للأستاذ',
    teacherViewAnnouncements_feature: 'خاصية: عرض الإعلانات للأساتذة',
    guardianViewSummaries_feature: 'خاصية: عرض الملخصات',
    guardianViewExercises_feature: 'خاصية: عرض التمارين',
    guardianViewNotesAndAbsences_feature: 'خاصية: عرض الملاحظات والغياب',
    guardianViewGrades_feature: 'خاصية: عرض النقط',
    guardianViewExamProgram_feature: 'خاصية: عرض برنامج الفروض',
    guardianViewPersonalizedExercises_feature: 'خاصية: عرض التمارين المخصصة',
    guardianViewSupplementaryLessons_feature: 'خاصية: عرض الدروس الداعمة',
    guardianViewUnifiedAssessments_feature: 'خاصية: عرض التقويمات الموحدة',
    guardianViewTimetable_feature: 'خاصية: عرض جدول الحصص',
    guardianViewQuizzes_feature: 'خاصية: عرض الاختبارات القصيرة',
    guardianViewProjects_feature: 'خاصية: عرض مشاريع الوحدة',
    guardianViewLibrary_feature: 'خاصية: عرض المكتبة الرقمية',
    guardianViewAlbum_feature: 'خاصية: عرض ألبوم الفصل',
    guardianPayFees_feature: 'خاصية: أداء الواجبات الشهرية',
    guardianSubmitComplaints_feature: 'خاصية: تقديم الشكاوى والاقتراحات',
    guardianRequestInterview_feature: 'خاصية: طلب مقابلة',
    guardianViewTalkingCards_feature: 'خاصية: عرض البطاقات الناطقة',
    // FIX: Corrected duplicate key by updating value and removing later re-definition.
    guardianViewMemorization_feature: 'خاصية: مساعد الحفظ للتلميذ',

    // Talking Cards Feature
    talkingCards: "البطاقات الناطقة",
    addTalkingCard: "إضافة بطاقة ناطقة",
    analyzeWithAI: "تحليل الصورة بالذكاء الاصطناعي",
    analyzing: "جاري التحليل...",
    reviewAIDetections: "مراجعة وتعديل النتائج",
    editAIDetections_desc: "يمكنك تعديل النصوص التي استخرجها الذكاء الاصطناعي أو حذفها قبل الحفظ.",
    saveCard: "حفظ البطاقة",
    cardSaved: "تم حفظ البطاقة بنجاح!",
    listen: "استماع",
    noTalkingCards: "لا توجد بطاقات ناطقة حاليا.",
    notificationNewTalkingCard: "تمت إضافة بطاقة ناطقة جديدة.",

    // Memorization Helper
    memorizationHelper: "مساعد الحفظ",
    addMemorizationItem: "إضافة مادة للحفظ",
    memorizationItemTitle: "عنوان المادة (مثال: سورة الفاتحة)",
    addByText: "إضافة نص",
    addByImage: "إضافة صورة",
    addByAudio: "تسجيل صوتي",
    contentText: "المحتوى النصي",
    recordAudio: "بدء التسجيل",
    stopRecording: "إيقاف التسجيل",
    listenToRecording: "الاستماع للتسجيل",
    saveItem: "حفظ المادة",
    itemSaved: "تم حفظ المادة بنجاح!",
    noMemorizationItems: "لا توجد مواد للحفظ حالياً.",
    repeat: "تكرار",
    repeatCount: "عدد مرات التكرار",
    infiniteRepeat: "تكرار مستمر",
    notificationNewMemorizationItem: "تمت إضافة مادة جديدة للحفظ في {subject}.",
    confirmDeleteMemorizationItem: "هل أنت متأكد من حذف هذه المادة؟",
    extractingTextFromImage: "جاري استخراج النص من الصورة...",
    
    // Super Admin Principal Management
    managePrincipals: "إدارة المديرين",
    principalManagementForStage: "إدارة المديرين للمرحلة: {stageName}",
    changePassword: "تغيير كلمة المرور",
    newPassword: "كلمة المرور الجديدة",
    savePassword: "حفظ كلمة المرور",
    principalName: "اسم المدير",
    confirmDeletePrincipal: "هل أنت متأكد من حذف المدير {name}؟",
    selectTeachers: 'اختر الأساتذة',
    all: 'الجميع',

    // Feedback Modal
    feedbackTitle: "ملاحظاتك تهمنا!",
    feedbackPrompt: "كيف تقيم تجربتك مع التطبيق؟",
    feedbackPlaceholder: "اكتب ملاحظاتك أو اقتراحاتك هنا لتحسين التطبيق...",
    send: "إرسال",
    later: "لاحقاً",
    feedbackThanks: "شكراً جزيلاً لملاحظاتك القيمة!",
    ratingRequired: "الرجاء تحديد تقييمك أولاً.",
    saveChanges: 'حفظ التغييرات',
    rememberMe: 'تذكرني',
    financialManagement: 'الإدارة المالية',
    financialSummary: 'ملخص مالي للشهر الحالي',
    totalIncome: 'إجمالي الدخل',
    totalExpenses: 'إجمالي المصاريف',
    netProfit: 'الربح الصافي',
    netLoss: 'الخسارة الصافية',
    expenses: 'المصاريف',
    teacherSalaries: 'رواتب الأساتذة',
    manualExpenses: 'مصاريف يدوية',
    addExpense: 'إضافة مصروف',
    expenseDescription: 'وصف المصروف',
    amount: 'المبلغ',
    income: 'الدخل',
    feedbackAnalysis: 'تحليل الملاحظات',
    feedbackAnalysisReport: 'تقرير تحليل الملاحظات',
    noFeedbackToAnalyze: 'لا توجد ملاحظات كافية للتحليل.',
    averageRating: 'متوسط التقييم',
    analyzeAllFeedback: 'تحليل كل الملاحظات',
    allFeedback: 'جميع الملاحظات',
    rating: 'التقييم',
    comments: 'التعليقات',
    userRole: 'الدور',
    school: 'المدرسة',
    enterAsPrincipal: 'الدخول كمدير',
    enterPrincipalDashboard: 'الدخول إلى لوحة تحكم {stageName}',

    // Search
    searchPlaceholder: "البحث في {schoolName}...",
    noResultsFound: "لم يتم العثور على نتائج.",
    searchResult: "نتيجة البحث",
    student: "تلميذ",
    teacher: "أستاذ",
    announcement: "إعلان",
    summary: "ملخص",
    exercise: "تمرين",
    note: "ملاحظة",
    educationalTip: "نصيحة تربوية",
    project: "مشروع",
    quiz: "اختبار",
    libraryItem: "كتاب",
    supplementaryLesson: "درس داعم",
    close: "إغلاق",
    details: "التفاصيل",
    principal: "مدير",
    contentDomainOptional: "المجال (اختياري)",
    changeStage: "تغيير المرحلة",
    dashboard: "لوحة التحكم",
    miscellaneous: "متنوع",
    confirmDeleteItem: "هل أنت متأكد من رغبتك في حذف \"{item}\"؟ لا يمكن التراجع عن هذا الإجراء.",
    actions: "الإجراءات",
    supabaseSettingsChecklistTitle: "قائمة تحقق لإعدادات Supabase",
    supabaseSettingsInstructions: "لضمان عمل التطبيق بشكل صحيح، **يجب** التأكد من أن الإعدادات التالية مطبقة في مشروعك على Supabase (اذهب إلى Authentication -> Settings):",
    supabaseAllowSignups: "تفعيل خيار 'Allow new users to sign up'",
    supabaseDisableEmailConfirm: "تعطيل خيار 'Confirm email'",
    supabaseEmailConfirmationNoteTitle: "ملاحظة هامة بخصوص إضافة المستخدمين",
    supabaseEmailConfirmationNoteBody: "لإضافة مستخدمين جدد (مديرين، أساتذة، أولياء أمور)، يجب التأكد من تعطيل خيار 'Confirm email'. هذا الإجراء ضروري لتمكين الدخول باستخدام الرموز السرية مباشرة.",

    // FIX: Added keys for better error handling
    principalCodeExists: "هذا الرمز السري مستخدم بالفعل. الرجاء اختيار رمز آخر.",
    failedToAddPrincipal: "فشل في إضافة المدير",
    failedToUpdateCode: "فشل في تحديث الرمز",
    failedToAddSchool: "فشل في إضافة المدرسة",
    failedToDeleteSchool: "فشل في حذف المدرسة",
    failedToDeletePrincipal: "فشل في حذف المدير",
    supabaseEmailConfirmationError: "فشل الدخول: خاصية تأكيد البريد الإلكتروني مفعلة.\n\n**لحل المشكلة:**\n1. اذهب إلى لوحة تحكم Supabase.\n2. اختر 'Authentication' ثم 'Settings'.\n3. قم بتعطيل خيار 'Confirm email'.\n4. اذهب إلى 'Users'، واحذف هذا المستخدم.\n5. حاول تسجيل الدخول مرة أخرى.",
    supabaseSignupsDisabledError: "فشل الدخول: تسجيل المستخدمين الجدد معطل.\n\n**لحل المشكلة:**\n1. اذهب إلى لوحة تحكم Supabase.\n2. اختر 'Authentication' ثم 'Settings'.\n3. قم **بتفعيل** خيار 'Allow new users to sign up'.\n4. حاول تسجيل الدخول مرة أخرى.",
    rlsNoticeTitle: "إعداد أمان هام: خطأ 'رمز غير صحيح'",
    rlsNoticeBody1: "للسماح للمستخدمين الجدد (مديرين، أساتذة، أولياء أمور) بتسجيل الدخول لأول مرة، يجب إضافة سياسة أمان (RLS) تسمح بالوصول للقراءة العلنية (anonymous read access).",
    rlsNoticeBody2: "بدون هذه السياسة، لن يتمكن التطبيق من العثور على رموز الدخول الجديدة، مما يؤدي إلى ظهور خطأ 'رمز غير صحيح' بشكل دائم.",
    rlsNoticeBody3: "الرجاء الذهاب إلى <strong>Database -&gt; Policies</strong> في Supabase وإضافة سياسة جديدة لكل من جداول <code>principals</code>, <code>teachers</code>, <code>students</code> تسمح بعملية <strong>SELECT</strong> للدور <strong>anon</strong>.",
  },
  fr: {
    discoverPleasureOfLearning: "Découvrez le plaisir d'apprendre",
    back: "Retour",
    logout: "Déconnexion",
    comingSoonTitle: "Bientôt disponible...",
    comingSoonMessage: "Cette fonctionnalité est en cours de développement. Restez à l'écoute pour les mises à jour !",
    notifications: "Notifications",
    noNewNotifications: "Aucune nouvelle notification.",
    notificationMessage: "Une nouvelle remarque a été ajoutée par le professeur en {subject}.",
    notificationNewSummary: "Un nouveau résumé a été ajouté en {subject}.",
    notificationNewExercise: "De nouveaux exercices ont été ajoutés en {subject}.",
    notificationNewExamProgram: "Un nouveau programme de contrôles a été ajouté en {subject}.",
    unifiedLoginWelcome: "Bienvenue sur l'application Imtiaz",
    unifiedLoginPrompt: "Veuillez entrer votre code d'accès",
    loginCodePlaceholder: "Code d'accès",
    login: "Connexion",
    requestHelp: "Demander de l'aide",
    helpNote: "Note : En cliquant sur 'Demander de l'aide', vous serez automatiquement redirigé pour appeler un numéro de téléphone.",
    invalidCode: "Code invalide. Veuillez réessayer ou demander de l'aide.",
    superAdminDashboardTitle: "Tableau de bord Super Admin",
    addSchoolSectionTitle: "Ajouter une nouvelle école",
    newSchoolNamePlaceholder: "Nom de la nouvelle école",
    principalSecretCodePlaceholder: "Code secret du directeur",
    addSchool: "Ajouter l'école",
    enterSchoolNameAndCode: "Veuillez entrer le nom de l'école et le code du directeur.",
    currentSchools: "Écoles actuelles",
    principalCodeLabel: "Code du directeur",
    delete: "Supprimer",
    confirmDeleteSchool: "Êtes-vous sûr de vouloir supprimer l'école \"{schoolName}\" ? Toutes ses données seront supprimées définitivement.",
    noSchoolsAdded: "Aucune école ajoutée pour le moment.",
    principalDashboardTitle: "Tableau de bord du Directeur",
    principalWelcome: "Bienvenue. Choisissez une action.",
    manageTeachers: "Gérer les enseignants",
    manageStudents: "Gérer les élèves",
    announcements: "Annonces",
    exercises: "Exercices",
    summaries: "Résumés",
    complaintsAndSuggestions: "Réclamations et Suggestions",
    educationalTips: "Conseils pédagogiques",
    performanceTracking: "Suivi des performances",
    reviewNotes: "Consulter les remarques",
    guardianDashboardTitle: "Tableau de bord Parent",
    studentLevel: "Niveau",
    selectSubjectToFollow: "Choisissez une matière",
    viewAnnouncements: "Voir les annonces",
    viewEducationalTips: "Voir les conseils",
    submitComplaintOrSuggestion: "Envoyer une réclamation",
    teacherDashboardTitle: "Tableau de bord Enseignant",
    teacherSelectLevelAndSubject: "Sélectionnez le niveau et la matière",
    level: "Niveau",
    subject: "Matière",
    next: "Suivant",
    add: 'Ajouter',
    teacherName: 'Nom de l\'enseignant(e)',
    loginCode: 'Code d\'accès',
    levels: 'Niveaux',
    classes: 'Groupes',
    addTeacher: 'Ajouter un enseignant',
    existingTeachers: 'Enseignants actuels',
    confirmDeleteTeacher: 'Êtes-vous sûr de vouloir supprimer l\'enseignant {name} ?',
    noTeachers: 'Aucun enseignant pour le moment.',
    edit: 'Modifier',
    updateTeacher: 'Mettre à jour',
    announcementContent: 'Contenu de l\'annonce',
    attachFile: 'Joindre un fichier (Image ou PDF)',
    targetAudience: 'Envoyer à',
    guardians: 'Parents',
    teachers: 'Enseignants',
    sendAnnouncement: 'Envoyer l\'annonce',
    sentAnnouncements: 'Annonces envoyées',
    complaintContent: 'Contenu de la réclamation / suggestion',
    submit: 'Envoyer',
    receivedComplaints: 'Réclamations et suggestions reçues',
    fromGuardianOf: 'Du parent de l\'élève',
    educationalTipContent: 'Contenu du conseil',
    generateWithAI: 'Générer avec l\'IA',
    sendTip: 'Envoyer le conseil',
    sentTips: 'Conseils envoyés',
    performanceOverview: 'Aperçu des performances',
    averageGradePerLevel: 'Moyenne par niveau',
    levelPerformance: 'Performance du niveau : {level}',
    studentName: 'Nom de l\'élève',
    averageGrade: 'Moyenne générale',
    performanceTrend: 'Tendance des performances',
    noComplaints: 'Aucune réclamation pour le moment.',
    noAnnouncements: 'Aucune annonce pour le moment.',
    noTips: 'Aucun conseil pour le moment.',
    confirm: 'Confirmer',
    cancel: 'Annuler',
    fillAllFields: 'Veuillez remplir tous les champs.',
    guardianNotesTitle: 'Remarques et Absences',
    addStudent: 'Ajouter un élève',
    guardianCode: 'Code du parent',
    existingStudents: 'Élèves actuels',
    confirmDeleteStudent: 'Êtes-vous sûr de vouloir supprimer l\'élève {name} ?',
    noStudents: 'Aucun élève pour le moment.',
    class: 'Classe',
    statisticsDashboard: 'Statistiques',
    interviewRequests: 'Demandes d\'entretien',
    monthlyFees: 'Frais mensuels',
    schoolManagement: 'Gestion de l\'école',
    importFromExcel: 'Importer depuis Excel',
    importInstructions: "Le fichier doit contenir deux colonnes : Noms des élèves et Codes des parents.",
    selectFile: 'Choisir un fichier Excel',
    import: 'Importer',
    importSuccess: '{count} élèves importés avec succès.',
    importError: 'Erreur d\'importation. Vérifiez le format du fichier.',
    selectLevelAndClass: 'Veuillez sélectionner le niveau et la classe.',
    manageSchool: 'Gérer l\'école',
    schoolStatus: 'Statut de l\'école',
    active: 'Active',
    inactive: 'Inactive',
    maintenanceTitle: 'Application en maintenance',
    maintenanceMessage: 'L\'application est en cours de maintenance. Veuillez réessayer plus tard.',
    statisticsDashboard_feature: "Stats",
    educationalTips_feature: "Conseils",
    announcements_feature: "Annonces",
    complaintsAndSuggestions_feature: "Réclamations",
    reviewNotes_feature: "Réviser les remarques",
    monthlyFees_feature: "Frais mensuels",
    interviewRequests_feature: "Demandes d'entretien",
    schoolManagement_feature: "Gestion de l'école",
    manage: "Gérer",
    featureToggleTitle: "Activer / Désactiver les fonctionnalités",
    browseAsTeacher: "Naviguer comme enseignant",
    browseAsTeacher_feature: "Naviguer comme enseignant",
    selectLevelAndSubjectPrompt: "Veuillez choisir le niveau, la matière et la classe",
    selectClassPrompt: "Veuillez choisir la classe",
    sendForReview: "Envoyer pour révision",
    sentForReviewSuccess: "Remarque envoyée pour révision !",
    aiGeneratedNote: "✨ Remarque de l'IA",
    feeNotification: "L'élève {studentName} a payé les frais de {amount} DH.",
    payNow: "Payer maintenant",
    paymentAmount: "Montant (DH)",
    paymentHistory: "Historique des paiements",
    paidOn: "Payé le",
    paymentSuccessful: "Paiement réussi !",
    requestInterview: "Demander un entretien",
    confirmRequestInterview: "Confirmer la demande",
    requestSent: "Demande envoyée.",
    paymentStatus: "Statut du paiement",
    paid: "Payé",
    notPaid: "Non payé",
    markAsPaid: "Marquer 'Payé'",
    principalFeeManagement: "État des paiements des élèves",
    noInterviewRequests: "Aucune demande d'entretien.",
    requestFrom: "Demande du parent de {studentName}",
    markAsCompleted: "Entretien terminé",
    monthlyFeePrompt: "Suivez et payez les frais mensuels ici.",
    noPayments: "Aucun paiement enregistré.",
    requestInterviewPrompt: "Confirmer la demande d'entretien avec l'administration ?",
    payByCard: "Payer par carte",
    cardDetails: "Infos de la carte",
    cardNumber: "Numéro de carte",
    expiryDate: "Expiration (MM/AA)",
    cvc: "CVC",
    cardholderName: "Nom du titulaire",
    confirmPayment: "Confirmer le paiement",
    processingPayment: "Paiement en cours...",
    academicYearMonths: "Mois de l'année scolaire",
    paymentDue: "Paiement requis",
    paymentCompleted: "Payé",
    pay: "Payer",
    setMonthlyFee: 'Définir les frais mensuels',
    // FIX: Added missing translation key for monthly fee screens.
    monthlyFee: 'Frais mensuels',
    monthlyFeeAmountLabel: 'Montant des frais mensuels (DH)',
    transportation: 'Transport',
    totalAmount: 'Montant total',
    setTransportationFee: 'Définir les frais de transport',
    transportationFeeAmountLabel: 'Montant des frais de transport (DH)',
    supplementaryLessons: 'Leçons de soutien',
    addSupplementaryLesson: 'Ajouter une leçon',
    lessonTitle: 'Titre/Lien de la leçon',
    externalLink: 'Lien externe (YouTube, etc.)',
    addLink: 'Ajouter le lien',
    noLessons: 'Aucune leçon de soutien.',
    timetable: 'Emploi du temps',
    addTimetable: 'Ajouter un emploi du temps',
    uploadTimetable: 'Télécharger (Image/PDF)',
    noTimetable: 'Aucun emploi du temps.',
    quizzes: 'Quiz',
    addQuiz: 'Ajouter un quiz',
    generateQuizFromImage: 'Créer un quiz depuis une image',
    uploadImageForQuiz: 'Téléchargez une image pour créer un quiz',
    generatingQuiz: 'Création du quiz...',
    quizGenerated: 'Quiz créé ! Veuillez le vérifier.',
    saveQuiz: 'Enregistrer le quiz',
    noQuizzes: 'Aucun quiz.',
    unitProject: 'Projet d\'unité',
    addProject: 'Ajouter un projet',
    projectTitle: 'Titre du projet',
    projectDescription: 'Description du projet',
    takePhoto: 'Prendre une photo',
    uploadPhoto: 'Télécharger une photo',
    noProjects: 'Aucun projet.',
    capture: 'Capturer',
    digitalLibrary: 'Bibliothèque numérique',
    addBook: 'Ajouter un livre',
    bookTitle: 'Titre du livre',
    bookDescription: 'Description',
    uploadBook: 'Télécharger (PDF)',
    download: 'Télécharger',
    noBooks: 'Bibliothèque vide.',
    manageFees: 'Gérer les frais',
    update: 'Mettre à jour',
    feesUpdated: 'Frais mis à jour !',
    lessonPlanner: 'Planificateur de leçons',
    lessonTopic: 'Sujet de la leçon',
    generatePlan: 'Créer le plan',
    generatingPlan: 'Création en cours...',
    lessonPlan: 'Plan de leçon',
    learningObjectives: 'Objectifs',
    inClassActivities: 'Activités en classe',
    homework: 'Devoirs',
    discussionQuestions: 'Questions de discussion',
    personalizedExercises: 'Exercices personnalisés',
    generateExercises: 'Créer des exercices',
    selectStudentForExercises: 'Choisir un élève',
    generatingExercises: 'Création en cours...',
    supportExercises: 'Exercices de soutien',
    enrichmentExercises: 'Exercices d\'approfondissement',
    saveAndSendExercises: 'Enregistrer et envoyer',
    noPersonalizedExercises: 'Aucun exercice personnalisé.',
    notificationNewPersonalizedExercise: 'Nouveaux exercices personnalisés ajoutés en {subject}.',
    insightsDashboard: 'Analyse des réclamations',
    analyzeComplaints: 'Analyser avec l\'IA',
    generatingAnalysis: 'Analyse en cours...',
    complaintAnalysis: 'Analyse des réclamations',
    commonThemes: 'Thèmes récurrents',
    sentimentSummary: 'Résumé des sentiments',
    noComplaintsToAnalyze: 'Pas assez de données pour analyser.',
    classAlbum: 'Album de la classe',
    addPhoto: 'Ajouter une photo',
    photoCaption: 'Légende de la photo',
    savePhoto: 'Enregistrer la photo',
    noPhotos: 'Album vide.',
    notificationNewPhoto: 'Nouvelle photo ajoutée à l\'album.',
    reviewAlbumPhotos: 'Réviser les photos',
    approve: 'Approuver',
    reject: 'Rejeter',
    pendingReview: 'En attente',
    approved: 'Approuvée',
    photoSentForReview: 'Photo envoyée pour révision.',
    noPhotosToReview: 'Aucune photo à réviser.',
    reviewAlbumPhotos_feature: 'Réviser les photos',
    notificationNewPhotoForReview: 'Une nouvelle photo attend votre révision.',
    unifiedAssessments: 'Évaluations unifiées',
    addUnifiedAssessment: 'Ajouter une évaluation',
    assessmentTitle: 'Titre de l\'évaluation',
    noAssessments: 'Aucune évaluation unifiée.',
    notificationNewUnifiedAssessment: 'Nouvelle évaluation unifiée en {subject}.',
    saveSuccess: 'Enregistré !',
    confirmDeleteAssessment: 'Supprimer cette évaluation ?',
    confirmDeleteQuiz: 'Supprimer ce quiz ?',
    confirmDeleteProject: 'Supprimer ce projet ?',
    notesAndAbsences: 'Remarques et Absences',
    studentGrades: 'Notes de l\'élève',
    examProgram: 'Programme des contrôles',
    aiNotes: 'Remarques par IA',
    notes: 'Remarques',
    darkMode: "Mode Nuit",
    pre_schoolStage: "Préscolaire",
    primaryStage: "Primaire",
    middleStage: "Collège",
    highStage: "Lycée",
    selectStage: "Choisir le cycle",
    'اللغة الإنجليزية': 'Anglais',
    'الفيزياء والكيمياء': 'Physique-Chimie',
    'علوم الحياة والأرض': 'SVT',
    'المعلوميات': 'Informatique',
    'الفلسفة': 'Philosophie',
    'التربية الإسلامية': 'Éducation Islamique',
    'الاجتماعيات': 'Histoire-Géo',
    'اللغة العربية': 'Arabe',
    'اللغة الفرنسية': 'Français',
    'الرياضيات': 'Mathématiques',
    principalFeaturesSection: "Fonctionnalités Directeur",
    teacherFeaturesSection: "Fonctionnalités Enseignant",
    guardianFeaturesSection: "Fonctionnalités Parent",
    financialManagement_feature: 'Gestion financière',
    teacherManageSummaries_feature: 'Gérer les résumés',
    teacherManageExercises_feature: 'Gérer les exercices',
    teacherManageNotesAndAbsences_feature: 'Gérer remarques/absences',
    teacherManageGrades_feature: 'Gérer les notes',
    teacherManageExamProgram_feature: 'Gérer programme contrôles',
    teacherGenerateAiNotes_feature: 'Remarques par IA',
    teacherLessonPlanner_feature: 'Planificateur de leçons IA',
    teacherPersonalizedExercises_feature: 'Exercices personnalisés IA',
    teacherManageSupplementaryLessons_feature: 'Gérer leçons de soutien',
    teacherManageUnifiedAssessments_feature: 'Gérer évaluations unifiées',
    teacherManageTimetable_feature: 'Gérer emplois du temps',
    teacherManageQuizzes_feature: 'Gérer les quiz',
    teacherManageProjects_feature: 'Gérer projets d\'unité',
    teacherManageLibrary_feature: 'Gérer bibliothèque',
    teacherManageAlbum_feature: 'Gérer l\'album de classe',
    // FIX: Added missing feature keys and consolidated definitions.
    teacherManageTalkingCards_feature: "Gérer les cartes parlantes",
    teacherManageMemorization_feature: "Assistant de mémorisation (Ens.)",
    teacherViewAnnouncements_feature: 'Voir les annonces',
    guardianViewSummaries_feature: 'Voir les résumés',
    guardianViewExercises_feature: 'Voir les exercices',
    guardianViewNotesAndAbsences_feature: 'Voir remarques/absences',
    guardianViewGrades_feature: 'Voir les notes',
    guardianViewExamProgram_feature: 'Voir programme contrôles',
    guardianViewPersonalizedExercises_feature: 'Voir exercices personnalisés',
    guardianViewSupplementaryLessons_feature: 'Voir leçons de soutien',
    guardianViewUnifiedAssessments_feature: 'Voir évaluations unifiées',
    guardianViewTimetable_feature: 'Voir l\'emploi du temps',
    guardianViewQuizzes_feature: 'Voir les quiz',
    guardianViewProjects_feature: 'Voir projets d\'unité',
    guardianViewLibrary_feature: 'Voir la bibliothèque',
    guardianViewAlbum_feature: 'Voir l\'album de classe',
    guardianPayFees_feature: 'Payer les frais',
    guardianSubmitComplaints_feature: 'Envoyer réclamations',
    guardianRequestInterview_feature: 'Demander un entretien',
    // FIX: Added missing feature keys and consolidated definitions.
    guardianViewTalkingCards_feature: "Voir les cartes parlantes",
    guardianViewMemorization_feature: "Assistant de mémorisation (Élève)",
    talkingCards: "Cartes parlantes",
    addTalkingCard: "Ajouter une carte parlante",
    analyzeWithAI: "Analyser avec l'IA",
    analyzing: "Analyse en cours...",
    reviewAIDetections: "Vérifier les résultats",
    editAIDetections_desc: "Modifiez ou supprimez les textes extraits par l'IA.",
    saveCard: "Enregistrer la carte",
    cardSaved: "Carte enregistrée !",
    listen: "Écouter",
    noTalkingCards: "Aucune carte parlante.",
    notificationNewTalkingCard: "Une nouvelle carte parlante a été ajoutée.",
    memorizationHelper: "Assistant de mémorisation",
    addMemorizationItem: "Ajouter un élément",
    memorizationItemTitle: "Titre (ex: Sourate Al-Fatiha)",
    addByText: "Texte",
    addByImage: "Image",
    addByAudio: "Audio",
    contentText: "Contenu textuel",
    recordAudio: "Enregistrer",
    stopRecording: "Arrêter",
    listenToRecording: "Écouter l'enregistrement",
    saveItem: "Enregistrer",
    itemSaved: "Enregistré !",
    noMemorizationItems: "Aucun élément à mémoriser.",
    repeat: "Répéter",
    repeatCount: "Nombre de répétitions",
    infiniteRepeat: "Répétition infinie",
    notificationNewMemorizationItem: "Nouvel élément à mémoriser en {subject}.",
    confirmDeleteMemorizationItem: "Supprimer cet élément ?",
    extractingTextFromImage: "Extraction du texte...",
    managePrincipals: "Gérer les directeurs",
    principalManagementForStage: "Gestion des directeurs pour : {stageName}",
    changePassword: "Changer le mot de passe",
    newPassword: "Nouveau mot de passe",
    savePassword: "Enregistrer",
    principalName: "Nom du directeur",
    confirmDeletePrincipal: "Supprimer le directeur {name} ?",
    selectTeachers: 'Choisir les enseignants',
    all: 'Tous',
    feedbackTitle: "Votre avis nous intéresse !",
    feedbackPrompt: "Comment évaluez-vous l'application ?",
    feedbackPlaceholder: "Écrivez vos commentaires ici...",
    send: "Envoyer",
    later: "Plus tard",
    feedbackThanks: "Merci pour vos commentaires !",
    ratingRequired: "Veuillez sélectionner une note.",
    saveChanges: 'Enregistrer',
    rememberMe: 'Se souvenir de moi',
    financialManagement: 'Gestion Financière',
    financialSummary: 'Résumé financier du mois',
    totalIncome: 'Revenus totaux',
    totalExpenses: 'Dépenses totales',
    netProfit: 'Bénéfice net',
    netLoss: 'Perte nette',
    expenses: 'Dépenses',
    teacherSalaries: 'Salaires des enseignants',
    manualExpenses: 'Dépenses manuelles',
    addExpense: 'Ajouter une dépense',
    expenseDescription: 'Description',
    amount: 'Montant',
    income: 'Revenus',
    feedbackAnalysis: 'Analyse des retours',
    feedbackAnalysisReport: 'Rapport d\'analyse',
    noFeedbackToAnalyze: 'Pas assez de données.',
    averageRating: 'Note moyenne',
    analyzeAllFeedback: 'Analyser les retours',
    allFeedback: 'Tous les retours',
    rating: 'Note',
    comments: 'Commentaires',
    userRole: 'Rôle',
    school: 'École',
    enterAsPrincipal: 'Entrer comme directeur',
    enterPrincipalDashboard: 'Accéder au tableau de bord {stageName}',
    searchPlaceholder: "Rechercher dans {schoolName}...",
    noResultsFound: "Aucun résultat.",
    searchResult: "Résultat de recherche",
    student: "Élève",
    teacher: "Enseignant",
    announcement: "Annonce",
    summary: "Résumé",
    exercise: "Exercice",
    note: "Remarque",
    educationalTip: "Conseil",
    project: "Projet",
    quiz: "Quiz",
    libraryItem: "Livre",
    supplementaryLesson: "Leçon de soutien",
    close: "Fermer",
    details: "Détails",
    principal: "Directeur",
    contentDomainOptional: "Domaine (optionnel)",
    changeStage: "Changer de cycle",
    dashboard: "Tableau de bord",
    miscellaneous: "Divers",
    confirmDeleteItem: "Êtes-vous sûr de vouloir supprimer \"{item}\" ? Cette action est irréversible.",
    actions: "Actions",
    supabaseSettingsChecklistTitle: "Checklist des paramètres Supabase",
    supabaseSettingsInstructions: "Pour assurer le bon fonctionnement de l'application, **vous devez** vérifier que les paramètres suivants sont appliqués dans votre projet Supabase (Allez à Authentication -> Settings) :",
    supabaseAllowSignups: "Activer l'option 'Allow new users to sign up'",
    supabaseDisableEmailConfirm: "Désactiver l'option 'Confirm email'",
    supabaseEmailConfirmationNoteTitle: "Note importante sur l'ajout d'utilisateurs",
    supabaseEmailConfirmationNoteBody: "Pour ajouter de nouveaux utilisateurs (directeurs, enseignants, parents), vous devez désactiver l'option 'Confirm email'. Ceci est nécessaire pour permettre la connexion directe avec les codes secrets.",
    
    // FIX: Added keys for better error handling
    principalCodeExists: "Ce code secret est déjà utilisé. Veuillez en choisir un autre.",
    failedToAddPrincipal: "Échec de l'ajout du directeur",
    failedToUpdateCode: "Échec de la mise à jour du code",
    failedToAddSchool: "Échec de l'ajout de l'école",
    failedToDeleteSchool: "Échec de la suppression de l'école",
    failedToDeletePrincipal: "Échec de la suppression du directeur",
    supabaseEmailConfirmationError: "Connexion échouée : La confirmation par e-mail est activée.\n\n**Pour corriger :**\n1. Allez sur votre tableau de bord Supabase.\n2. Allez à 'Authentication' puis 'Settings'.\n3. Désactivez l'option 'Confirm email'.\n4. Allez à 'Users', et supprimez cet utilisateur.\n5. Réessayez de vous connecter.",
    supabaseSignupsDisabledError: "Connexion échouée : L'inscription de nouveaux utilisateurs est désactivée.\n\n**Pour corriger :**\n1. Allez sur votre tableau de bord Supabase.\n2. Allez à 'Authentication' puis 'Settings'.\n3. **Activez** l'option 'Allow new users to sign up'.\n4. Réessayez de vous connecter.",
    rlsNoticeTitle: "Important Security Setting: 'Invalid Code' Error",
    rlsNoticeBody1: "To allow new users (principals, teachers, guardians) to log in for the first time, a Row Level Security (RLS) policy must be added to allow anonymous read access.",
    rlsNoticeBody2: "Without this policy, the app cannot find new login codes, causing the 'Invalid Code' error to appear permanently.",
    rlsNoticeBody3: "Please go to <strong>Database -&gt; Policies</strong> in Supabase and add a new policy for each of the tables <code>principals</code>, <code>teachers</code>, and <code>students</code> that allows the <strong>SELECT</strong> operation for the <strong>anon</strong> role.",
  },
  en: {
    // ...
  }
};


const LanguageContext = createContext({
  language: 'ar' as Language,
  setLanguage: (lang: Language) => {},
  t: (key: keyof typeof translations.ar, options?: {[key: string]: string | number}) => key as string
});

export const useTranslation = () => useContext(LanguageContext);

export const LanguageProvider: React.FC<{children: React.ReactNode}> = ({ children }) => {
  const [language, setLanguageState] = useState<Language>('ar');

  useEffect(() => {
    const savedLang = localStorage.getItem('language') as Language;
    if (savedLang && ['ar', 'fr', 'en'].includes(savedLang)) {
      setLanguageState(savedLang);
    }
  }, []);
  
  useEffect(() => {
    document.documentElement.lang = language;
    document.documentElement.dir = language === 'ar' ? 'rtl' : 'ltr';
    localStorage.setItem('language', language);
  }, [language]);

  const setLanguage = (lang: Language) => {
    setLanguageState(lang);
  };

  const t = useCallback((key: keyof typeof translations.ar, options?: {[key: string]: string | number}) => {
    const langDict = translations[language] || translations.ar;
    let translation = (langDict as any)[key] || key;

    if (options) {
      Object.keys(options).forEach(k => {
        translation = translation.replace(`{${k}}`, String(options[k]));
      });
    }

    return translation;
  }, [language]);

  // FIX: Rewritten to use React.createElement to avoid JSX syntax in a .ts file.
  return React.createElement(
    LanguageContext.Provider,
    { value: { language, setLanguage, t } },
    children
  );
};
